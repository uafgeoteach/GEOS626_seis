% dvips -t letter lab_tomo.dvi -o lab_tomo.ps ; ps2pdf lab_tomo.ps
\documentclass[11pt,titlepage,fleqn]{article}

\input{hw626_header}

\newcommand{\tfile}{{\tt lab\_tomo.ipynb}}

% change the figures to ``Figure L3'', etc
\renewcommand{\thefigure}{L\arabic{figure}}
\renewcommand{\thetable}{L\arabic{table}}
\renewcommand{\theequation}{L\arabic{equation}}
\renewcommand{\thesection}{L\arabic{section}}

%--------------------------------------------------------------
\begin{document}
%-------------------------------------------------------------

\begin{spacing}{1.2}
\centering
{\large \bf Lab Exercise: Basis functions for seismic tomography [tomo]} \\
\cltag\ \\
%Assigned: April 10, 2014 --- Due: April 17, 2014 \\
Last compiled: \today
\end{spacing}

%------------------------

\subsection*{Overview}

This lab is preparation for {\tt hw\_tomo.pdf}. The template notebook is \tfile. Here we focus on three concepts: 1) using basis functions to build other functions, 2) discretizing ray paths on the surface of a sphere, and 3) numerical integration.

\subsection*{Questions}

A tomographic model is typically described in terms of a perturbation in wave speed structure from some reference model, \ie $\delta\ln c = \delta c/c$.
(Note \footnote{See the section entitled ``ASIDE: the natural log function used to express tomographic models'' in the {\tt hw\_math} solutions.})
This function may be expanded in terms of a set of $M$ basis functions:
%
\begin{equation}
\delta\ln c(\bx)=\sum_{k=1}^{\nparm} \delta m_k\,B_k(\bx),
\label{dlnv}
\end{equation}
%
where $\delta m_k$, $k=1,\ldots,\nparm$, represent the model coefficients describing the model perturbation $\delta\ln c(\bx)$, and $B_k(\bx)$ is a basis function. Here we choose to use spherical spline basis functions \citep{WangDahlen1995spline,Wang1998}.

\begin{enumerate}

\item Run the Python script \verb+lab_tomo.ipynb+ in order to familiarize yourself with spherical spline basis functions. This script will generate a spherical spline basis function of grid order $q$, centered at a randomly selected gridpoint. Change the value for $q$ and see what happens. 
%An example of a $q = 8$ basis function is shown in \refFig{fig:basis}b.

\item What are the values of the $q=8$ spline function that is centered at (longitude, latitude) = $(-117^\circ,\;34^\circ)$, evaluated at the points $(\phi,\;34^\circ)$, where $\phi = -117, -117.05, \ldots, -118$?

\item In order to construct a matrix of partial derivatives for the tomographic inversion, you will need to know how to integrate functions along ray paths that are on the sphere. 

Discretize a ray path between two points on the sphere.

Use \verb+Geod()+ from the pyproj module.

\item How will you perform numerically integrate a function evaluated along a ray path?

\end{enumerate}

%-------------------------------------------------------------
%\pagebreak
\bibliography{uaf_abbrev,uaf_main,uaf_carletal}
%-------------------------------------------------------------

%-------------------------------------------------------------
\end{document}
%-------------------------------------------------------------
